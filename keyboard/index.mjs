import{$1,$fmod,$hsv2rgb,$time}from"/util.mjs";const audios1=Array(12).fill().map(((e,t)=>new Audio(`./sounds/down${t+1}.mp3`))),audios2=Array(11).fill().map(((e,t)=>new Audio(`./sounds/up${t+1}.mp3`)));onload=()=>{const e=document.querySelector(".keyboard");window.keyboardEl=e;for(const t of e.children)for(const e of t.children)e.innerText="";const t=[["Escape","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","PrintScreen","ScrollLock","Pause"],["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backspace","Insert","Home","PageUp"],["Tab","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","Delete","End","PageDown"],["CapsLock","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Enter"],["ShiftLeft","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","ShiftRight","ArrowUp"],["ControlLeft","MetaLeft","AltLeft","Space","AltRight","Fn","ContextMenu","ControlRight","ArrowLeft","ArrowDown","ArrowRight"]],o=[];for(let e=0;e<t.length;++e){o.push([]);for(let n=0;n<t[e].length;++n)o[e].push({value:0,pressed:!1})}function n(e){for(let o=0;o<t.length;++o)for(let n=0;n<t[o].length;++n)if(t[o][n]==e)return[n,o]}console.log(o),addEventListener("keydown",(e=>{if(e.repeat)return;const t=n(e.code);t&&(new Audio(`./sounds/down${~~(12*Math.random()+1)}.mp3`).play(),o[t[1]][t[0]].pressed=!0,e.preventDefault())})),addEventListener("keyup",(e=>{const t=n(e.code);t&&(new Audio(`./sounds/up${~~(11*Math.random()+1)}.mp3`).play(),o[t[1]][t[0]].pressed=!1,e.preventDefault())})),addEventListener("blur",(()=>e.classList.add("blurred"))),addEventListener("focus",(()=>e.classList.remove("blurred")));let r=performance.now();const i=()=>{const t=performance.now(),n=t-r,s=e.getBoundingClientRect();let l=0;for(const t of e.children){let e=0;for(const r of t.children){const t=o[l][e];t.pressed?t.value=1:t.value=Math.max(t.value-n/200,0);const i=r.getBoundingClientRect();r.style.background=$hsv2rgb([0,0,80*t.value+20]).toString();const a=$hsv2rgb([((i.left-s.left+i.width/2)/s.width-performance.now()/1e3/2)%1*360,60*(1-t.value),100]).toString();r.style["box-shadow"]=`0 0 6px ${a}`,r.style["border-color"]=a,++e}++l}r=t,setTimeout(i,20)};i()};